<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<img id="avatar" src="../img/avatar.jpg" style="display: none">
<canvas id="canvas" height="500" width="500" style="border: 1px solid pink"></canvas>
<script>
    window.onload = function () {
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");
        var avatar = document.getElementById("avatar");
        ctx.drawImage(avatar, 10, 10, 100, 100);
        var img=ctx.getImageData(0, 0, 110, 110);
        var imgData = img.data;
        for (var i = 0; i <imgData.length; i += 4) {
            var red = imgData[i],
                    green = imgData[i + 1],
                    blue = imgData[i + 2],
                    alpha=imgData[i+3];
            var average=Math.floor((red+green+blue)/3);
            imgData[i]=imgData[i+1]=imgData[i+2]=imgData[i+3]=average;
        }
        img.data=imgData;
        ctx.putImageData(img,0,0);
    }
</script>
</body>
</html>